label: GPMS Obligations
rules:
  - label: create_proposal
    event:
      subject:
        anyUser:
      operations:
        - assign to
      target:
        policyElements:
          - name: PDS
            type: OA
    response:
      actions:
        - assign:
            what:
              - function:
                  name: current_user
            where:
              - name: PI
                type: UA
        - create:
            what:
              - function:
                  name: create_node
                  args: 
                    - function:
                        name: get_node_name 
                        args:
                          - function:
                              name: current_user
                    - O
                    - function:
                        name: to_props
                        args:
                          - key1 = value1
            where:
              - name: PI-Info
                type: OA
  - label: add_copi
    event:
      subject:
        anyUser:
      operations:
        - assign to
      target:
        policyElements:
          - name: CoPI
            type: UA
    response:
      actions:
        - create:
            what:
              - function:
                  name: create_node
                  args: 
                    - function:
                        name: get_node_name 
                        args:
                          - function:
                              name: child_of_assign
                    - O
                    - function:
                        name: to_props
                        args:
                          - key1 = value1
            where:
              - name: CoPI-Info
                type: OA  
  - label: add_sp
    event:
      subject:
        anyUser:
      operations:
        - assign to
      target:
        policyElements:
          - name: SP
            type: UA
    response:
      actions:
        - create:
            what:
              - function:
                  name: create_node
                  args: 
                    - function:
                        name: get_node_name 
                        args:
                          - function:
                              name: child_of_assign
                    - O
                    - function:
                        name: to_props
                        args:
                          - key1 = value1
            where:
              - name: SP-Info
                type: OA
  - label: delete_sp
    event:
      subject:
        anyUser:
      operations:
        - deassign from
      target:
        policyElements:
          - name: SP
            type: UA
    response:
      actions:
        - delete:
            create:
              what:
                - name: dave
                  type: O
              where:
                - name: SP-Info
                  type: OA      
  - label: submit_proposal
    event:
      subject:
        anyUser:
      operations:
        - assign to
      target:
        policyElements:
          - name: Submission-Info
            type: OA
    response:
      actions:
        - deny:
            label: deny_this_ev
            subject:
              name: PI
              type: UA
              properties: 
            operations:
              - w
            target:
              complement: false
              intersection: false
              containers:
                - name: PI-Editable-Data
                  type: OA                     