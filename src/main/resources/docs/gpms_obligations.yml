label: GPMS Obligations
rules:
  - label: create_proposal
    event:
      subject:
        anyUser:
      operations:
        - assign to
      target:
        policyElements:
          - name: PDS
            type: OA
    response:
      actions:
        - assign:
            - what:
                function:
                  name: current_user
              where:
                  name: PI
                  type: UA
        - function:
            name: create_node1
            args:
              - PI-Info
              - OA 
              - function:
                  name: concat_strings
                  args:
                    - function:
                        name: get_node_name
                        args:
                          - function:
                              name: current_user
                    - PI
              - O
  - label: add_copi
    event:
      subject:
        anyUser:
      operations:
        - assign to
      target:
        policyElements:
          - name: CoPI
            type: UA
    response:
      actions:
        - function:
            name: create_node1
            args:
              - CoPI-Info
              - OA 
              - function:
                  name: concat_strings
                  args:
                    - function:
                        name: get_node_name
                        args:
                          - function:
                              name: child_of_assign
                    - CoPI
              - O                    
        - assign:
            - what:
                function:
                  name: child_of_assign
              where:
                name: CoPI
                type: UA  
        - assign:
            - what:
                function:
                  name: findChairForCoPI
                  args: 
                    - function:
                        name: child_of_assign              
              where:
                name: Chair
                type: UA
        - assign:
            - what:
                function:
                  name: findDeanForCoPI
                  args: 
                    - function:
                        name: child_of_assign              
              where:
                name: Dean
                type: UA
        - assign:
            - what:
                function:
                  name: findBMForCoPI
                  args: 
                    - function:
                        name: child_of_assign              
              where:
                name: Business-Manager
                type: UA                
                                                             
                    